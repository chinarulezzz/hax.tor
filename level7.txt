https://hax.tor.hu/level7/
-------------------------
https://securiteam.com/tools/6Q00I0UEUM

T 193.23.143.43:23566 -> 10.0.0.2:1433 [AP]
  12 01 00 2f 00 00 01 00    00 00 1a 00 06 01 00 20    .../...........
  00 01 02 00 21 00 01 03    00 22 00 04 04 00 26 00    ....!...."....&.
  01 ff 09 00 00 00 00 00    00 00 00 00 00 48 00       .............H.

T 10.0.0.2:1433 -> 193.23.143.43:23566 [AP]
  04 01 00 25 00 00 01 00    00 00 15 00 06 01 00 1b    ...%............
  00 01 02 00 1c 00 01 03    00 1d 00 00 ff 08 00 07    ................
  f7 00 00 02 00                                        .....

T 193.23.143.43:23566 -> 10.0.0.2:1433 [AP]
  10 01 01 56 00 00 01 00    4e 01 00 00 02 00 09 72    ...V....N......r

  -- TDS Login Packet (offset start) --

  00 10 00 00 00 00 00 06    90 09 00 00 00 00 00 00    ................
  e0 03 00 00 00 00 00 00    00 00 00 00 5e 00 03 00    ............^...
                                                  |
  +-----------------------------------------------+
  |<- username_offset_ptr (0x0064 = 100)
  |
  |  +<- username_length_ptr (0x000b = 11)
  |  |     
  |  |     + password_offset_ptr (0x007a = 122)
  |  |     |
  |  |     |     + password_length_ptr (0x0009 = 9)
  |  |     |     |
  +  +--+  +---+ +--+
  |  |  |  |   | |  |
  64 00 0b 00 7a 00 09 00    8c 00 2e 00 e8 00 17 00    d...z...........
  16 01 00 00 16 01 1c 00    4e 01 00 00 4e 01 00 00    ........N...N...
  1a 37 5d bb 2f dc 4e 01    00 00 4e 01 00 00 4e 01    .7]./.N...N...N.

                                             + username (11*2 = 22 length)
                                             |
                                         +--------+           
  00 00 00 00 00 00 48 00    41 00 4b 00 74 00 72 00    ......H.A.K.t.r.
  61 00 6e 00 73 00 61 00    63 00 74 00 69 00 6f 00    a.n.s.a.c.t.i.o.
  6e 00                                                 n.
                        + password (9*2 = 18 length)
                        |
        +-----------------------------------------+
        b1 a5 93 a5 e2 a5    f6 a5 c6 a5 b6 a5 11 a5      ..............
  f3 a5 32 a5                                           ..2.
              4d 00 69 00    63 00 72 00 6f 00 73 00        M.i.c.r.o.s.
  6f 00 66 00 74 00 20 00    53 00 51 00 4c 00 20 00    o.f.t. .S.Q.L. .
  53 00 65 00 72 00 76 00    65 00 72 00 20 00 4d 00    S.e.r.v.e.r. .M.
  61 00 6e 00 61 00 67 00    65 00 6d 00 65 00 6e 00    a.n.a.g.e.m.e.n.
  74 00 20 00 53 00 74 00    75 00 64 00 69 00 6f 00    t. .S.t.u.d.i.o.
  20 00 45 00 78 00 70 00    72 00 65 00 73 00 73 00     .E.x.p.r.e.s.s.
  62 00 61 00 6e 00 6b 00    73 00 6f 00 66 00 74 00    b.a.n.k.s.o.f.t.
  2e 00 6e 00 6f 00 74 00    72 00 6c 00 79 00 2e 00    ..n.o.t.r.l.y...
  68 00 75 00 2c 00 36 00    30 00 30 00 32 00 2e 00    h.u.,.6.0.0.2...
  4e 00 65 00 74 00 20 00    53 00 71 00 6c 00 43 00    N.e.t. .S.q.l.C.
  6c 00 69 00 65 00 6e 00    74 00 20 00 44 00 61 00    l.i.e.n.t. .D.a.
  74 00 61 00 20 00 50 00    72 00 6f 00 76 00 69 00    t.a. .P.r.o.v.i.
  64 00 65 00 72 00                                     d.e.r.

T 10.0.0.2:1433 -> 193.23.143.43:23566 [AP]
  04 01 01 7d 00 36 01 00    e3 1b 00 01 06 74 00 65    ...}.6.......t.e
  00 6d 00 70 00 64 00 62    00 06 6d 00 61 00 73 00    .m.p.d.b..m.a.s.
  74 00 65 00 72 00 ab 68    00 45 16 00 00 02 00 25    t.e.r..h.E.....%
  00 43 00 68 00 61 00 6e    00 67 00 65 00 64 00 20    .C.h.a.n.g.e.d.
  00 64 00 61 00 74 00 61    00 62 00 61 00 73 00 65    .d.a.t.a.b.a.s.e
  00 20 00 63 00 6f 00 6e    00 74 00 65 00 78 00 74    . .c.o.n.t.e.x.t
  00 20 00 74 00 6f 00 20    00 27 00 74 00 65 00 6d    . .t.o. .'.t.e.m
  00 70 00 64 00 62 00 27    00 2e 00 09 53 00 5a 00    .p.d.b.'....S.Z.
  56 00 4d 00 53 00 5a 00    4b 00 30 00 31 00 00 00    V.M.S.Z.K.0.1...
  00 e3 08 00 07 05 0e 04    d0 00 00 00 e3 17 00 02    ................
  0a 75 00 73 00 5f 00 65    00 6e 00 67 00 6c 00 69    .u.s._.e.n.g.l.i
  00 73 00 68 00 00 ab 6c    00 47 16 00 00 01 00 27    .s.h...l.G.....'
  00 43 00 68 00 61 00 6e    00 67 00 65 00 64 00 20    .C.h.a.n.g.e.d.
  00 6c 00 61 00 6e 00 67    00 75 00 61 00 67 00 65    .l.a.n.g.u.a.g.e
  00 20 00 73 00 65 00 74    00 74 00 69 00 6e 00 67    . .s.e.t.t.i.n.g
  00 20 00 74 00 6f 00 20    00 75 00 73 00 5f 00 65    . .t.o. .u.s._.e
  00 6e 00 67 00 6c 00 69    00 73 00 68 00 2e 00 09    .n.g.l.i.s.h....
  53 00 5a 00 56 00 4d 00    53 00 5a 00 4b 00 30 00    S.Z.V.M.S.Z.K.0.
  31 00 00 00 00 ad 36 00    01 71 00 00 01 16 4d 00    1.....6..q....M.
  69 00 63 00 72 00 6f 00    73 00 6f 00 66 00 74 00    i.c.r.o.s.o.f.t.
  20 00 53 00 51 00 4c 00    20 00 53 00 65 00 72 00     .S.Q.L. .S.e.r.
  76 00 65 00 72 00 00 00    00 00 08 00 07 f7 e3 13    v.e.r...........
  00 04 04 34 00 30 00 39    00 36 00 04 34 00 30 00    ...4.0.9.6..4.0.
  39 00 36 00 fd 00 00 00    00 00 00 00 00             9.6..........


Decrypt:
-------

        uint8_t password[] =
                "\xb1"
                "\x93"
                "\xe2"
                "\xf6"
                "\xc6"
                "\xb6"
                "\x11"
                "\xf3"
                "\x32";

        for (int i=0; i<9; i++) {
                uint8_t p = password[i] ^ 0xa5;
                printf("%c", (p << 4) | (p >> 4));
        }



